name: Holiday deals email

on:
  schedule:
    - cron: "0 7 * * *" # 7am UTC every day
  workflow_dispatch: {}

jobs:
  ping:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    env:
      APP_BASE_URL: ${{ secrets.APP_BASE_URL }}
      CRON_SECRET: ${{ secrets.CRON_SECRET }}
    steps:
      - name: Call email endpoint
        run: |
          echo "Calling: $APP_BASE_URL/api/alerts/email"
          curl -sS --fail-with-body -X POST "$APP_BASE_URL/api/alerts/email" \
            -H "x-cron-secret: $CRON_SECRET" \
            -H "content-type: application/json" \
            -d '{}'
